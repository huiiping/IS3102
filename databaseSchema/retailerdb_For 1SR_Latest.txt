--------------------------------------------------------
Check Log
CAA: 9 March 1840 hrs

Order of tables:
01. cust_membership_tiers
02. customers
03. locations
04. retailer_details
05. retailer_employee_roles
06. retailer_employees
07. suppliers
08. supplier_memos
09. messages
10. promotions
11. purchase_orders
12. purchase_order_items
13. sections
14. prod_cats
15. products
16. prod_specifications
17. promotion_emails
18. retailer_loggings
19. inventory
20. cust_membership_tiers_promotions
21. retailer_employees_retailer_employee_roles
22. retailer_employees_messages
23. promotions_products
24. products_prod_specifications
--------------------------------------------------------

CREATE TABLE cust_membership_tiers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tier_name VARCHAR(255) NOT NULL,
    validity_period INT NOT NULL,
    min_spending VARCHAR(100),
    membership_fee VARCHAR(100),
    membership_pts INT,
    redemption_pts INT,
    discount_rate VARCHAR(100),
    birthday_rate VARCHAR(100),
    description TEXT, 
    created DATETIME,
    modified DATETIME
);

CREATE TABLE customers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    address VARCHAR(255) NOT NULL,
    contact VARCHAR(100) NOT NULL,
    created DATETIME,
    modified DATETIME,
    first_name VARCHAR(255) NOT NULL,
    last_name VARCHAR(255) NOT NULL,
    activation_status VARCHAR(100),
    activation_token VARCHAR(100),
    recovery_status VARCHAR(100),
    recovery_token VARCHAR(100),
    mailing_list BOOLEAN,
    expiry_date DATETIME,
    cust_membership_tier_id INT NOT NULL,
    FOREIGN KEY (cust_membership_tier_id) REFERENCES cust_membership_tiers(id)
);

CREATE TABLE locations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255),
    address VARCHAR(255),
    contact INT,
    type VARCHAR(100)
);

CREATE TABLE retailer_details (
    retailerid INT PRIMARY KEY,
    retailer_name VARCHAR(255) NOT NULL,
    retailer_desc TEXT,
    retailer_email VARCHAR(255) NOT NULL,
    address VARCHAR(255) NOT NULL,
    contact VARCHAR(100) NOT NULL
);

CREATE TABLE retailer_employee_roles (
    id INT AUTO_INCREMENT PRIMARY KEY,
    role_name VARCHAR(255) NOT NULL,
    role_desc TEXT
);

CREATE TABLE retailer_employees (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    address VARCHAR(255) NOT NULL,
    contact VARCHAR(100) NOT NULL,
    created DATETIME,
    modified DATETIME,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    activation_status VARCHAR(100),
    activation_token VARCHAR(100),
    recovery_status VARCHAR(100),
    recovery_token VARCHAR(100),
    location_id INT,
    FOREIGN KEY (location_id) REFERENCES locations(id)
);

CREATE TABLE suppliers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL,
    address VARCHAR(255) NOT NULL,
    contact VARCHAR(100) NOT NULL,
    created DATETIME,
    modified DATETIME,
    supplier_name VARCHAR(255),
    country VARCHAR(255),
    activation_status VARCHAR(100),
    activation_token VARCHAR(100),
    recovery_status VARCHAR(100),
    recovery_token VARCHAR(100),
    bank_acc VARCHAR(255)
);

CREATE TABLE supplier_memos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    remarks VARCHAR(255),
    created DATETIME,
    supplier_id INT,
    retailer_employee_id INT,
    FOREIGN KEY (supplier_id) REFERENCES suppliers(id),
    FOREIGN KEY (retailer_employee_id) REFERENCES retailer_employees(id)
);

CREATE TABLE messages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(255),
    created DATETIME,
    modified DATETIME,
    message TEXT,
    status BOOLEAN,
    attachment VARCHAR(100),
    attachmentID INT,
    sender_id INT,
    FOREIGN KEY (sender_id) REFERENCES retailer_employees(id)
);

CREATE TABLE promotions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    start_date DATETIME,
    end_date DATETIME,
    promo_desc TEXT,
    first_voucher_num VARCHAR(100),
    last_voucher_num VARCHAR(100),
    discount_rate DOUBLE,
    credit_card_type VARCHAR(100),
    retailer_employee_id INT,
    FOREIGN KEY (retailer_employee_id) REFERENCES retailer_employees(id)
);

CREATE TABLE purchase_orders (
    id INT AUTO_INCREMENT PRIMARY KEY,
    created DATETIME,
    total_price DOUBLE,
    approval_status VARCHAR(100),
    delivery_status BOOLEAN,
    supplier_id INT,
    retailer_employee_id INT,
    FOREIGN KEY (supplier_id) REFERENCES suppliers(id),
    FOREIGN KEY (retailer_employee_id) REFERENCES retailer_employees(id)
);

CREATE TABLE purchase_order_items (
    id INT AUTO_INCREMENT PRIMARY KEY,
    item_ID INT,
    item_name VARCHAR(255),
    item_desc TEXT,
    quantity INT,
    unit_price DOUBLE,
    sub_total_price DOUBLE,
    purchase_order_id INT,
    FOREIGN KEY (purchase_order_id) REFERENCES purchase_orders(id)
);

CREATE TABLE sections (
    id INT AUTO_INCREMENT PRIMARY KEY,
    sec_name VARCHAR(100),
    available_space INT NOT NULL,
    space_limit INT,
    reserve BOOLEAN,
    location_id INT,
    FOREIGN KEY (location_id) REFERENCES locations(id)
);

CREATE TABLE prod_cats (
    id INT AUTO_INCREMENT PRIMARY KEY,
    parentid INT,
    cat_name VARCHAR(100) UNIQUE NOT NULL,
    cat_desc TEXT
);

CREATE TABLE products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    prod_name VARCHAR(100),
    prod_desc TEXT,
    store_unit_price DOUBLE,
    web_store_unit_price DOUBLE,
    SKU VARCHAR(100),
    prod_cat_id INT,
    FOREIGN KEY (prod_cat_id) REFERENCES prod_cats(id)
);

CREATE TABLE prod_specifications (
    title VARCHAR(255) PRIMARY KEY,
    description VARCHAR(255) NOT NULL
);

CREATE TABLE promotion_emails (
    id INT AUTO_INCREMENT PRIMARY KEY,
    promotion_id INT,
    cust_membership_tier_id INT,
    title VARCHAR(100),
    body VARCHAR(255),
    last_sent DATETIME,
    number_of_sends INT,
    created DATETIME,
    modified DATETIME,
    FOREIGN KEY (promotion_id) REFERENCES promotions(id),
    FOREIGN KEY (cust_membership_tier_id) REFERENCES cust_membership_tiers(id)
);

CREATE TABLE retailer_loggings (
    id INT AUTO_INCREMENT PRIMARY KEY,
    action VARCHAR(100),
    entity VARCHAR(100),
    entityid INT,
    retailer_employee_id INT NOT NULL,
    created DATETIME,
    FOREIGN KEY (retailer_employee_id) REFERENCES retailer_employees(id)
);

CREATE TABLE inventory (
  id INT AUTO_INCREMENT PRIMARY KEY,
  product_id INT NOT NULL,
  SKU VARCHAR(100) NOT NULL,
  quantity INT NOT NULL,
  section_id INT NOT NULL,
  location_id INT NOT NULL,
  FOREIGN KEY (product_id) REFERENCES products(id),
  FOREIGN KEY (section_id) REFERENCES sections(id),
  FOREIGN KEY (location_id) REFERENCES locations(id)
);

CREATE TABLE cust_membership_tiers_promotions (
    cust_membership_tier_id INT NOT NULL,
    promotion_id INT NOT NULL,
    PRIMARY KEY (cust_membership_tier_id, promotion_id),
    FOREIGN KEY (cust_membership_tier_id) REFERENCES cust_membership_tiers(id),
    FOREIGN KEY (promotion_id) REFERENCES promotions(id)
);

CREATE TABLE retailer_employees_retailer_employee_roles (
    retailer_employee_id INT NOT NULL,
    retailer_employee_role_id INT NOT NULL,
    PRIMARY KEY (retailer_employee_id, retailer_employee_role_id),
    FOREIGN KEY (retailer_employee_id) REFERENCES retailer_employees(id),
    FOREIGN KEY (retailer_employee_role_id) REFERENCES retailer_employee_roles(id)
);

CREATE TABLE retailer_employees_messages (
    retailer_employee_id INT NOT NULL,
    message_id INT NOT NULL,
    PRIMARY KEY (retailer_employee_id, message_id),
    FOREIGN KEY (retailer_employee_id) REFERENCES retailer_employees(id),
    FOREIGN KEY (message_id) REFERENCES messages(id)
);

CREATE TABLE promotions_products (
    promotion_id INT NOT NULL,
    product_id INT NOT NULL,
    PRIMARY KEY (promotion_id, product_id),
    FOREIGN KEY (promotion_id) REFERENCES promotions(id),
    FOREIGN KEY (product_id) REFERENCES products(id)
);

CREATE TABLE products_prod_specifications (
    product_id INT NOT NULL,
    prod_specification_title VARCHAR(255) NOT NULL,
    PRIMARY KEY (product_id, prod_specification_title),
    FOREIGN KEY (product_id) REFERENCES products(id),
    FOREIGN KEY (prod_specification_title) REFERENCES prod_specifications(title)
);


